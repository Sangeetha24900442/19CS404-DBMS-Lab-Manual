# Experiment 5: Subqueries and Views
### NAME : Sangeetha S
### REG NO : 212224040287
## AIM
To study and implement subqueries and views.

## THEORY

### Subqueries
A subquery is a query inside another SQL query and is embedded in:
- WHERE clause
- HAVING clause
- FROM clause

**Types:**
- **Single-row subquery**:
  Sub queries can also return more than one value. Such results should be made use along with the operators in and any.
- **Multiple-row subquery**:
  Here more than one subquery is used. These multiple sub queries are combined by means of ‘and’ & ‘or’ keywords.
- **Correlated subquery**:
  A subquery is evaluated once for the entire parent statement whereas a correlated Sub query is evaluated once per row processed by the parent statement.

**Example:**
```sql
SELECT * FROM employees
WHERE salary > (SELECT AVG(salary) FROM employees);
```
### Views
A view is a virtual table based on the result of an SQL SELECT query.
**Create View:**
```sql
CREATE VIEW view_name AS
SELECT column1, column2 FROM table_name WHERE condition;
```
**Drop View:**
```sql
DROP VIEW view_name;
```

**Question 1**
--
Write a SQL query to retrieve all columns from the CUSTOMERS table for customers whose salary is greater than $1500.

```
SELECT *
FROM CUSTOMERS
WHERE SALARY > 1500;

```

**Output:**

<img width="1206" height="621" alt="Screenshot 2025-11-21 075818" src="https://github.com/user-attachments/assets/cc99f8f3-3a66-43c6-946e-76b280892fe9" />


**Question 2**
---
From the following tables, write a SQL query to find those salespeople who earned the maximum commission. Return ord_no, purch_amt, ord_date, and salesman_id.
```
SELECT ord_no, purch_amt,ord_date, salesman_id
FROM orders
WHERE salesman_id IN (
    SELECT salesman_id
    FROM salesman
    WHERE commission = (
        SELECT MAX(commission)
        FROM salesman
    )
);


```

**Output:**

<img width="1054" height="491" alt="Screenshot 2025-11-21 075827" src="https://github.com/user-attachments/assets/7583e5d3-6860-4183-9443-71d50ea37fbf" />


**Question 3**
---
Write a query to display all the customers whose ID is the difference between the salesperson ID of Mc Lyon and 2001.

```
SELECT *
FROM customer
WHERE customer_id = (
    SELECT salesman_id - 2001
    FROM salesman
    WHERE name = 'Mc Lyon'
);


```

**Output:**


<img width="1206" height="358" alt="Screenshot 2025-11-21 075835" src="https://github.com/user-attachments/assets/6352ac07-6aa8-432a-9f67-deb2d3b7d689" />

**Question 4**
---
From the following tables write a SQL query to find all orders generated by New York-based salespeople. Return ord_no, purch_amt, ord_date, customer_id, salesman_id.

```
SELECT  ord_no, purch_amt,ord_date, customer_id, orders.salesman_id
FROM orders
WHERE salesman_id IN (
    SELECT salesman_id
    FROM salesman
    WHERE city = 'New York'
);

```

**Output:**

<img width="1236" height="487" alt="Screenshot 2025-11-21 075844" src="https://github.com/user-attachments/assets/061ec8b1-27c8-40a1-8c13-f3f87da1a555" />



**Question 5**
---
From the following tables write a SQL query to find salespeople who had more than one customer. Return salesman_id and name.

```
SELECT s.salesman_id, s.name
FROM salesman s
WHERE s.salesman_id IN (
    SELECT salesman_id
    FROM customer
    GROUP BY salesman_id
    HAVING COUNT(customer_id) > 1
);

```

**Output:**

<img width="731" height="500" alt="Screenshot 2025-11-21 075851" src="https://github.com/user-attachments/assets/4eaefc60-8b93-49c2-bb92-e44b8920adfb" />


**Question 6**
---
Write a SQL query that retrieves the names of students and their corresponding grades, where the grade is equal to the minimum grade achieved in each subject.

Sample table: GRADES (attributes: student_id, student_name, subject, grade)

```
SELECT student_name, grade
FROM GRADES g
WHERE grade = (
    SELECT MIN(grade)
    FROM GRADES
    WHERE subject = g.subject
);

```

**Output:**

<img width="798" height="479" alt="Screenshot 2025-11-21 075859" src="https://github.com/user-attachments/assets/42607c19-8296-4295-858b-934fecd12df0" />



**Question 7**
---
Write a SQL query to Retrieve the medications with dosages equal to the lowest dosage

Table Name: Medications (attributes: medication_id, medication_name, dosage)

```
SELECT medication_id AS medic, medication_name, dosage
FROM Medications
WHERE dosage = (
    SELECT MIN(dosage)
    FROM Medications
);

```

**Output:**

<img width="897" height="435" alt="Screenshot 2025-11-21 075907" src="https://github.com/user-attachments/assets/f8a1396f-465a-49bc-bbbb-effae7bed20d" />

**Question 8**
---
Write a SQL query to Retrieve the medications with dosages equal to the highest dosage

```
SELECT medication_id AS medic, medication_name, dosage
FROM Medications
WHERE dosage = (
    SELECT MAX(dosage)
    FROM Medications
);

```

**Output:**

<img width="920" height="430" alt="Screenshot 2025-11-21 075914" src="https://github.com/user-attachments/assets/c5fa0521-4610-4711-9aa5-e57d221f3218" />



**Question 9**
---
From the following tables write a SQL query to count the number of customers with grades above the average in New York City. Return grade and count.

```
SELECT grade, COUNT(*) FROM customer 
WHERE grade > (SELECT AVG(grade) FROM customer WHERE city = 'New York') 
GROUP BY grade;

```

**Output:**

<img width="753" height="372" alt="Screenshot 2025-11-21 075921" src="https://github.com/user-attachments/assets/cd1d77b9-47dc-4c69-a5ff-1127a79923e4" />



**Question 10**
---
Write a SQL query to retrieve all columns from the CUSTOMERS table for customers whose Address as Delhi and age below 30

Sample table: CUSTOMERS

```
SELECT *
FROM CUSTOMERS
WHERE ADDRESS = 'Delhi'
  AND AGE < 30
  group by ID;

```

**Output:**


<img width="1183" height="406" alt="Screenshot 2025-11-21 075928" src="https://github.com/user-attachments/assets/48f6672e-2c42-4d31-9650-81842af8c62a" />

## RESULT
Thus, the SQL queries to implement subqueries and views have been executed successfully.
